---
title: "PlotSapflow"
author: "Azura Liu"
date: '2022-06-13'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("dplyr")
library("tidyverse")
library("lubridate")
library("readxl")
library("writexl")

getwd()
Sections<-read_excel("../Data/Processed/Sapwood/17SectionalSums.xlsx")
Sapflux<-read_excel("../Data/Processed/Sapflow/Jul17/Sapflux.xlsx")
```

```{r}
LA<-Sapflux%>%
  mutate(ID = "LA")%>%
  filter(grepl("LA",Tree))%>%
  select(36, 4:35)

LAFlux<-aggregate(LA[3:33], by = list(LA$Position,LA$ID),FUN = "mean")

LB<-Sapflux%>%
  mutate(ID = "LB")%>%
  filter(grepl("LB",Tree))%>%
  select(36, 4:35)

LBFlux<-aggregate(LB[3:33], by = list(LB$Position,LB$ID),FUN = "mean")

LC<-Sapflux%>%
  mutate(ID = "LC")%>%
  filter(grepl("LC",Tree))%>%
  select(36, 4:35)

LCFlux<-aggregate(LC[3:33], by = list(LC$Position,LC$ID),FUN = "mean")

LO<-Sapflux%>%
  mutate(ID = "LO")%>%
  filter(grepl("LO",Tree))%>%
  select(36, 4:35)

LOFlux<-aggregate(LO[3:33], by = list(LO$Position,LO$ID),FUN = "mean")

HA<-Sapflux%>%
  mutate(ID = "HA")%>%
  filter(grepl("HA",Tree))%>%
  select(36, 4:35)

HAFlux<-aggregate(HA[3:33], by = list(HA$Position,HA$ID),FUN = "mean")

HB<-Sapflux%>%
  mutate(ID = "HB")%>%
  filter(grepl("HB",Tree))%>%
  select(36, 4:35)

HBFlux<-aggregate(HB[3:33], by = list(HB$Position,HB$ID),FUN = "mean")

HC<-Sapflux%>%
  mutate(ID = "HC")%>%
  filter(grepl("HC",Tree))%>%
  select(36, 4:35)

HCFlux<-aggregate(HC[3:33], by = list(HC$Position,HC$ID),FUN = "mean")

HO<-Sapflux%>%
  mutate(ID = "HO")%>%
  filter(grepl("HO",Tree))%>%
  select(36, 4:35)

HOFlux<-aggregate(HO[3:33], by = list(HO$Position,HO$ID),FUN = "mean")


SapfluxbyPop<-rbind(LAFlux,LBFlux,LCFlux,LOFlux,HAFlux,HBFlux,HCFlux,HOFlux)

names(SapfluxbyPop)[1]<-"Section"
names(SapfluxbyPop)[2]<-"ID"

```

```{r}
names(Sections)[4]<-"LA"
names(Sections)[5]<-"LB"
names(Sections)[6]<-"LC"
names(Sections)[7]<-"LO"
names(Sections)[8]<-"HA"
names(Sections)[9]<-"HB"
names(Sections)[10]<-"HC"
names(Sections)[11]<-"HO"


SectionWrangle<-Sections%>%
  pivot_longer(cols = LA:HO, names_to = "ID", values_to = "Area")

SapfluxbyPop$Section <- gsub("I","Inner",SapfluxbyPop$Section)
SapfluxbyPop$Section <- gsub("O","Outer",SapfluxbyPop$Section)

SapfluxWrangle<-SapfluxbyPop%>%
  pivot_longer(cols = 3:33, names_to = "DOY", values_to = "Sapflux")

Deep<-SapfluxWrangle%>%
  filter(Section == "Inner")%>%
  mutate(Sapflux=Sapflux/2)
Deep$Section<-gsub("Inner","Deep",Deep$Section)

SapfluxJuly<-rbind(SapfluxWrangle,Deep)
```

```{r}
SectionJuly<-SectionWrangle%>%
  subset(DOY>181 & DOY <213)
SapfluxJuly$DOY<-as.double(SapfluxJuly$DOY)

JulySapflow<-inner_join(SectionJuly, SapfluxJuly,by = c("DOY", "Section", "ID"))%>%
  mutate(Sapflow=Sapflux*Area/10000)

Weather<-read.csv("../Data/Processed/Sums/Converted/S1.Sum.7.csv")

VPD<-Weather%>%
  filter(Interval=="24hr")%>%
  select(DOY, VPD)

JulyMeta<-inner_join(JulySapflow, VPD, by="DOY")

#library("writexl")
#write_xlsx(JulyMeta, "../Data/Processed/Sapflow/Jul17/PlotLevelSapflow.xlsx")
```

```{r}

LAFlow1<-JulyMeta%>%
  filter(ID == "LA" & Block == 1)
LAFlow2<-JulyMeta%>%
  filter(ID == "LA" & Block == 2)
LAFlow3<-JulyMeta%>%
  filter(ID == "LA" & Block == 3)
LAFlow4<-JulyMeta%>%
  filter(ID == "LA" & Block == 4)


LBFlow1<-JulyMeta%>%
  filter(ID == "LB" & Block == 1)
LBFlow2<-JulyMeta%>%
  filter(ID == "LB" & Block == 2)
LBFlow3<-JulyMeta%>%
  filter(ID == "LB" & Block == 3)
LBFlow4<-JulyMeta%>%
  filter(ID == "LB" & Block == 4)


LCFlow1<-JulyMeta%>%
  filter(ID == "LC" & Block == 1)
LCFlow2<-JulyMeta%>%
  filter(ID == "LC" & Block == 2)
LCFlow3<-JulyMeta%>%
  filter(ID == "LC" & Block == 3)
LCFlow4<-JulyMeta%>%
  filter(ID == "LC" & Block == 4)


LOFlow1<-JulyMeta%>%
  filter(ID == "LO" & Block == 1)
LOFlow2<-JulyMeta%>%
  filter(ID == "LO" & Block == 2)
LOFlow3<-JulyMeta%>%
  filter(ID == "LO" & Block == 3)
LOFlow4<-JulyMeta%>%
  filter(ID == "LO" & Block == 4)


HAFlow1<-JulyMeta%>%
  filter(ID == "HA" & Block == 1)
HAFlow2<-JulyMeta%>%
  filter(ID == "HA" & Block == 2)
HAFlow3<-JulyMeta%>%
  filter(ID == "HA" & Block == 3)
HAFlow4<-JulyMeta%>%
  filter(ID == "HA" & Block == 4)


HBFlow1<-JulyMeta%>%
  filter(ID == "HB" & Block == 1)
HBFlow2<-JulyMeta%>%
  filter(ID == "HB" & Block == 2)
HBFlow3<-JulyMeta%>%
  filter(ID == "HB" & Block == 3)
HBFlow4<-JulyMeta%>%
  filter(ID == "HB" & Block == 4)


HCFlow1<-JulyMeta%>%
  filter(ID == "HC" & Block == 1)
HCFlow2<-JulyMeta%>%
  filter(ID == "HC" & Block == 2)
HCFlow3<-JulyMeta%>%
  filter(ID == "HC" & Block == 3)
HCFlow4<-JulyMeta%>%
  filter(ID == "HC" & Block == 4)


HOFlow1<-JulyMeta%>%
  filter(ID == "HO" & Block == 1)
HOFlow2<-JulyMeta%>%
  filter(ID == "HO" & Block == 2)
HOFlow3<-JulyMeta%>%
  filter(ID == "HO" & Block == 3)
HOFlow4<-JulyMeta%>%
  filter(ID == "HO" & Block == 4)
```

```{r}
LASapflow1<-ggplot(LAFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LA1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LA1.jpg", LASapflow1, height = 7, width = 10, units = "in", dpi = 500)

LASapflow2<-ggplot(LAFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LA2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LA2.jpg", LASapflow2, height = 7, width = 10, units = "in", dpi = 500)

LASapflow3<-ggplot(LAFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LA3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LA3.jpg", LASapflow3, height = 7, width = 10, units = "in", dpi = 500)

LASapflow4<-ggplot(LAFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LA4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LA4.jpg", LASapflow4, height = 7, width = 10, units = "in", dpi = 500)


LBSapflow1<-ggplot(LBFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LB1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LB1.jpg", LBSapflow1, height = 7, width = 10, units = "in", dpi = 500)

LBSapflow2<-ggplot(LBFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LB2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LB2.jpg", LBSapflow2, height = 7, width = 10, units = "in", dpi = 500)

LBSapflow3<-ggplot(LBFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LB3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LB3.jpg", LBSapflow3, height = 7, width = 10, units = "in", dpi = 500)

LBSapflow4<-ggplot(LBFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LB4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LB4.jpg", LBSapflow4, height = 7, width = 10, units = "in", dpi = 500)

LCSapflow1<-ggplot(LCFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LC1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LC1.jpg", LCSapflow1, height = 7, width = 10, units = "in", dpi = 500)

LCSapflow2<-ggplot(LCFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LC2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LC2.jpg", LCSapflow2, height = 7, width = 10, units = "in", dpi = 500)

LCSapflow3<-ggplot(LCFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LC3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LC3.jpg", LCSapflow3, height = 7, width = 10, units = "in", dpi = 500)

LCSapflow4<-ggplot(LCFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LC4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LC4.jpg", LCSapflow4, height = 7, width = 10, units = "in", dpi = 500)

LOSapflow1<-ggplot(LOFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LO1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LO1.jpg", LOSapflow1, height = 7, width = 10, units = "in", dpi = 500)

LOSapflow2<-ggplot(LOFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LO2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LO2.jpg", LOSapflow2, height = 7, width = 10, units = "in", dpi = 500)

LOSapflow3<-ggplot(LOFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LO3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LO3.jpg", LOSapflow3, height = 7, width = 10, units = "in", dpi = 500)

LOSapflow4<-ggplot(LOFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("LO4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/LO4.jpg", LOSapflow4, height = 7, width = 10, units = "in", dpi = 500)

HASapflow1<-ggplot(HAFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HA1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HA1.jpg", HASapflow1, height = 7, width = 10, units = "in", dpi = 500)

HASapflow2<-ggplot(HAFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HA2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HA2.jpg", HASapflow2, height = 7, width = 10, units = "in", dpi = 500)

HASapflow3<-ggplot(HAFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HA3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HA3.jpg", HASapflow3, height = 7, width = 10, units = "in", dpi = 500)

HASapflow4<-ggplot(HAFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HA4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HA4.jpg", HASapflow4, height = 7, width = 10, units = "in", dpi = 500)

HBSapflow1<-ggplot(HBFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HB1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HB1.jpg", HBSapflow1, height = 7, width = 10, units = "in", dpi = 500)

HBSapflow2<-ggplot(HBFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HB2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HB2.jpg", HBSapflow2, height = 7, width = 10, units = "in", dpi = 500)

HBSapflow3<-ggplot(HBFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HB3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HB3.jpg", HBSapflow3, height = 7, width = 10, units = "in", dpi = 500)

HBSapflow4<-ggplot(HBFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HB4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HB4.jpg", HBSapflow4, height = 7, width = 10, units = "in", dpi = 500)

HCSapflow1<-ggplot(HCFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HC1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HC1.jpg", HCSapflow1, height = 7, width = 10, units = "in", dpi = 500)

HCSapflow2<-ggplot(HCFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HC2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HC2.jpg", HCSapflow2, height = 7, width = 10, units = "in", dpi = 500)

HCSapflow3<-ggplot(HCFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HC3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HC3.jpg", HCSapflow3, height = 7, width = 10, units = "in", dpi = 500)

HCSapflow4<-ggplot(HCFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HC4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HC4.jpg", HCSapflow4, height = 7, width = 10, units = "in", dpi = 500)

HOSapflow1<-ggplot(HOFlow1, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HO1 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HO1.jpg", HOSapflow1, height = 7, width = 10, units = "in", dpi = 500)

HOSapflow2<-ggplot(HOFlow2, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HO2 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HO2.jpg", HOSapflow2, height = 7, width = 10, units = "in", dpi = 500)

HOSapflow3<-ggplot(HOFlow3, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HO3 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HO3.jpg", HOSapflow3, height = 7, width = 10, units = "in", dpi = 500)

HOSapflow4<-ggplot(HOFlow4, aes(DOY))+
  scale_x_continuous()+
  geom_point(aes(y=Sapflow, color=Section))+
  geom_point(aes(y=VPD, color = "VPD"))+
  ggtitle("HO4 Plot Level Sapflow")

ggsave("../Data/Processed/Sapflow/Jul17/SapflowGraphs/HO4.jpg", HOSapflow4, height = 7, width = 10, units = "in", dpi = 500)
```

